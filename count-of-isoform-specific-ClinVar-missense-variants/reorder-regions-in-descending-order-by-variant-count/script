# Define file paths
input_file <- "Homo_sapiens.GRCh38.112.chr_patch_hapl_scaff_isoform_specific_regions_with_variant_counts.bed"
output_file <- "Homo_sapiens.GRCh38.112.chr_patch_hapl_scaff_isoform_specific_regions_with_variant_counts_in_descending_order.bed"

# Read the input BED file
bed_data <- read.table(input_file, header = FALSE, sep = "\t", stringsAsFactors = FALSE)

# Ensure the last column (variant count) is numeric
bed_data[, ncol(bed_data)] <- as.numeric(bed_data[, ncol(bed_data)])

# Check for NA values after conversion
if(any(is.na(bed_data[, ncol(bed_data)]))) {
  stop("Error: The last column contains non-numeric values that cannot be converted.")
}

# Sort the data by the last column (variant count) in descending order
sorted_bed_data <- bed_data[order(-bed_data[, ncol(bed_data)]), ]

# Write the sorted data to the output file
write.table(sorted_bed_data, file = output_file, sep = "\t", row.names = FALSE, col.names = FALSE, quote = FALSE)

# Print a message indicating completion
cat("The rows have been sorted by variant count in descending order and saved to", output_file, "\n")
