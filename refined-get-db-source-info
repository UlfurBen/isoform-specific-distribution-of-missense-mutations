# Extract identifiers from the FASTA file
gunzip -c uniprot_sprot_varsplic.fasta.gz | grep 'KMT2A_HUMAN' > temp.txt

# Process identifiers and count occurrences
awk -F '[|-]' '{print $2}' temp.txt | sort -u > temp_identifiers.txt

while read -r identifier; do
    count_mutation=$(gunzip -c homo_sapiens_variation.txt.gz | grep -w "$identifier" | grep 'missense variant' | wc -l)
    count_gnomAD=$(gunzip -c homo_sapiens_variation.txt.gz | grep -w "$identifier" | grep 'gnomAD' | grep 'missense variant' | wc -l)
    echo "${identifier},${count_mutation},${count_gnomAD}" >> output-3.txt
done < temp_identifiers.txt

awk -F '|' '{print $2}' temp.txt | sort -u > temp_identifiers_2.txt

while read -r identifier; do
    count_mutation=$(gunzip -c homo_sapiens_variation.txt.gz | grep -w "$identifier" | grep 'missense variant' | wc -l)
    count_gnomAD=$(gunzip -c homo_sapiens_variation.txt.gz | grep -w "$identifier" | grep 'gnomAD' | grep 'missense variant' | wc -l)
    echo "${identifier},${count_mutation},${count_gnomAD}" >> output-3.txt
done < temp_identifiers_2.txt

# Clean up temporary files
rm temp.txt temp_identifiers.txt temp_identifiers_2.txt
